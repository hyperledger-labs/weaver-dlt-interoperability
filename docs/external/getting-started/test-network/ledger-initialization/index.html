<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="alternate" type="application/rss+xml" href="/weaver-dlt-interoperability/blog/rss.xml" title="Weaver: DLT Interoperability Framework RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/weaver-dlt-interoperability/blog/atom.xml" title="Weaver: DLT Interoperability Framework Atom Feed"><title data-react-helmet="true">Ledger Initialization | Weaver: DLT Interoperability Framework</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://hyperledger-labs.github.io/weaver-dlt-interoperability/docs/external/getting-started/test-network/ledger-initialization"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Ledger Initialization | Weaver: DLT Interoperability Framework"><meta data-react-helmet="true" name="description" content="&lt;!--"><meta data-react-helmet="true" property="og:description" content="&lt;!--"><link data-react-helmet="true" rel="shortcut icon" href="/weaver-dlt-interoperability/shared/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hyperledger-labs.github.io/weaver-dlt-interoperability/docs/external/getting-started/test-network/ledger-initialization"><link data-react-helmet="true" rel="alternate" href="https://hyperledger-labs.github.io/weaver-dlt-interoperability/docs/external/getting-started/test-network/ledger-initialization" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://hyperledger-labs.github.io/weaver-dlt-interoperability/docs/external/getting-started/test-network/ledger-initialization" hreflang="x-default"><link rel="stylesheet" href="/weaver-dlt-interoperability/assets/css/styles.e404a13c.css">
<link rel="preload" href="/weaver-dlt-interoperability/assets/js/runtime~main.862315ac.js" as="script">
<link rel="preload" href="/weaver-dlt-interoperability/assets/js/main.5ca17011.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/weaver-dlt-interoperability/"><div class="navbar__logo"><img src="/weaver-dlt-interoperability/shared/logo.svg" alt="Weaver" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/weaver-dlt-interoperability/shared/logo.svg" alt="Weaver" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Weaver</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/weaver-dlt-interoperability/docs/external/introduction">Docs</a><a class="navbar__item navbar__link" href="/weaver-dlt-interoperability/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hyperledger-labs/weaver-dlt-interoperability" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/weaver-dlt-interoperability/docs/external/introduction">Weaver Framework</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/weaver-dlt-interoperability/docs/external/getting-started/guide">Using Weaver</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Launching a Test Network</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/weaver-dlt-interoperability/docs/external/getting-started/test-network/overview">Component Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/weaver-dlt-interoperability/docs/external/getting-started/test-network/setup-local">Setup with Locally Built Weaver Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/weaver-dlt-interoperability/docs/external/getting-started/test-network/setup-local-docker">Setup with Locally Built Dockerized Weaver Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/weaver-dlt-interoperability/docs/external/getting-started/test-network/setup-packages">Setup with Imported Weaver Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/weaver-dlt-interoperability/docs/external/getting-started/test-network/setup-packages-docker">Setup with Imported Dockerized Weaver Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/weaver-dlt-interoperability/docs/external/getting-started/test-network/ledger-initialization">Ledger Initialization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/weaver-dlt-interoperability/docs/external/getting-started/test-network/advanced-configuration">Advanced Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Testing Interoperation Modes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Enabling Weaver in your Network and Application</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">What is Interoperability?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/weaver-dlt-interoperability/docs/external/interoperability-modes">Interoperability Modes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/weaver-dlt-interoperability/docs/external/design-principles">Design Principles</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">User Stories</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Architecture and Design</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security Model</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deployment Considerations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/weaver-dlt-interoperability/docs/external/specifications">Specifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/weaver-dlt-interoperability/docs/external/roadmap">Roadmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/weaver-dlt-interoperability/docs/external/publications">Publications</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Ledger Initialization</h1></header><p>Once the two Fabric networks and the Corda network are up and running along with their associated relays and drivers, we must initialize states in those networks to prepare them for interoperation. For the Fabric networks, this involves recording state in the channel ledgers, and for the Corda network, in the nodes&#x27; vaults. The configuration and bootstrapping takes different form depending on what <a href="/weaver-dlt-interoperability/docs/external/interoperability-modes">interoperability mode</a> you wish to test.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="preparation-for-data-sharing">Preparation for Data Sharing<a aria-hidden="true" class="hash-link" href="#preparation-for-data-sharing" title="Direct link to heading">â€‹</a></h2><p>Follow the below instructions to prepare your networks for data sharing tests.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="initializing-the-fabric-networks">Initializing the Fabric Networks<a aria-hidden="true" class="hash-link" href="#initializing-the-fabric-networks" title="Direct link to heading">â€‹</a></h3><p>We use the Fabric CLI (<code>fabric-cli</code>) built earlier (in <code>samples/fabric/fabric-cli</code> and <code>samples/fabric/go-cli</code>) for this purpose.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="configuring-the-fabric-cli">Configuring the Fabric CLI<a aria-hidden="true" class="hash-link" href="#configuring-the-fabric-cli" title="Direct link to heading">â€‹</a></h4><p>During bootstrap, the ledgers in both <code>network1</code> and <code>network2</code> must be populated with the following information scoped by the interoperation chaincode:</p><ul><li>Access control policies governing requests from foreign networks</li><li>Security group info for foreign networks (i.e., identities of network units and their membership providers&#x27; certificate chains)</li><li>Verification policies for proofs supplied by foreign networks
Knowledge of foreign networks that must be configured in this stage is as follows:</li><li><code>network1</code> has policies and security group info for <code>network2</code> and <code>Corda_Network</code></li><li><code>network2</code> has policies and security group info for <code>network1</code> and <code>Corda_Network</code>
(<em><code>Corda_Network</code> will be launched later.</em>)
The ledgers must also be populated with sample key-value pairs for testing interoperation flows, scoped by the sample application chaincode.</li></ul><p>Prepare <code>fabric-cli</code> for configuration suitably as follows.</p><ul><li>Navigate to the <code>samples/fabric/fabric-cli</code> (for the Node.js version) or the <code>samples/fabric/go-cli</code> (for the Golang version) folder.</li><li>Create a <code>config.json</code> file by copying the <code>config.template.json</code> and setting (or adding or removing) suitable values:<ul><li>For each network, the relay port and connection profile paths are specified using the keys <code>relayPort</code> and <code>connProfilePath</code> respectively.<ul><li>Replace <code>&lt;PATH-TO-WEAVER&gt;</code> with the absolute path location of the <code>weaver-dlt-interoperability</code> clone folder.</li><li>Otherwise, leave the default values unchanged.</li></ul></li></ul></li><li>Create a <code>chaincode.json</code> file by copying the <code>chaincode.json.template</code> and leaving the default values unchanged. This file specified the arguments of the transaction to be locally invoked after fetching a remote view.</li><li>Create a <code>.env</code> file by copying <code>.env.template</code> and setting the following parameter values:<ul><li>If Relays and Drivers are deployed in the host machine:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MEMBER_CREDENTIAL_FOLDER=&lt;PATH-TO-WEAVER&gt;/samples/fabric/fabric-cli/src/data/credentials</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFAULT_APPLICATION_CHAINCODE=&lt;chaincode-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFAULT_APPLICATION_FUNC=&lt;function-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CONFIG_PATH=./config.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CHAINCODE_PATH=./chaincode.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>If Relays and Drivers are deployed in the Docker containers:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MEMBER_CREDENTIAL_FOLDER=&lt;PATH-TO-WEAVER&gt;/samples/fabric/fabric-cli/src/data/credentials_docker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFAULT_APPLICATION_CHAINCODE=&lt;chaincode-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFAULT_APPLICATION_FUNC=&lt;function-name&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CONFIG_PATH=./config.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CHAINCODE_PATH=./chaincode.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>In each case, replace <code>&lt;PATH-TO-WEAVER&gt;</code> with the location of your clone of Weaver and <code>&lt;chaincode-name&gt;</code> with the name of the deployed chaincode, either <code>simplestate</code> or <code>simplestatewithacl</code>.</li><li>If <code>simplestate</code> is deployed, set <code>&lt;function-name&gt;</code> to <code>Create</code>, and if <code>simplestatewithacl</code> if deployed, set <code>&lt;function-name&gt;</code> to <code>CreateFromRemote</code>.</li><li>Leave the default values unchanged for the other parameters.</li></ul></li><li>Run the following command:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/fabric-cli </span><span class="token function" style="color:rgb(130, 170, 255)">env</span><span class="token plain"> set-file ./.env</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><table><thead><tr><th align="left">Notes</th></tr></thead><tbody><tr><td align="left">If the <code>CONFIG_PATH</code> environment variable is omitted from <code>.env</code>, then you must also run:<br><code>./bin/fabric-cli config set-file ./config.json</code></td></tr></tbody></table></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="bootstrapping-network-and-application-state">Bootstrapping Network and Application State<a aria-hidden="true" class="hash-link" href="#bootstrapping-network-and-application-state" title="Direct link to heading">â€‹</a></h4><p>Finally, to prepare both <code>network1</code> and <code>network2</code> for interoperation, run:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/fabric-cli configure all network1 network2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Instead, if you launched only one of the two Fabric networks, run the following after replacing <code>&lt;network-id&gt;</code> with either <code>network1</code> or <code>network2</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/fabric-cli configure all </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">network-id</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="initializing-the-corda-networks">Initializing the Corda Networks<a aria-hidden="true" class="hash-link" href="#initializing-the-corda-networks" title="Direct link to heading">â€‹</a></h3><p>Once the Corda networks are launched, the client applications (built earlier) needs to be exercised to generate network (ledger) state in preparation to test interoperation flows.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="bootstrapping-networks-and-application-states">Bootstrapping Networks and Application States<a aria-hidden="true" class="hash-link" href="#bootstrapping-networks-and-application-states" title="Direct link to heading">â€‹</a></h4><p>Just as we did for either Fabric network, the Corda network ledger (or <em>vault</em> on each node) must be initialized with access control policies, verification policies, and security group information for the two Fabric networks. Further, sample key-value pairs need to be recorded so we can later share them with a Fabric network via an interoperation flow.</p><p>Bootstrap the Corda networks and application states as follows (<em>the following instructions will initialize either or both Corda networks, depending on which of those are up and running</em>):</p><ul><li>Navigate to the <code>samples/corda/corda-simple-application</code> folder.</li><li>Run the following: <ul><li>If Relays and Drivers are deployed in the host machine:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">make</span><span class="token plain"> initialise-vault</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>If Relays and Drivers are deployed in the Docker containers:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">make</span><span class="token plain"> initialise-vault-docker</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="next-steps">Next Steps<a aria-hidden="true" class="hash-link" href="#next-steps" title="Direct link to heading">â€‹</a></h3><p>The test networks are now configured and their ledgers are initialized. You can now run the <a href="/weaver-dlt-interoperability/docs/external/getting-started/interop/data-sharing">data sharing flows</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="preparation-for-asset-exchange">Preparation for Asset Exchange<a aria-hidden="true" class="hash-link" href="#preparation-for-asset-exchange" title="Direct link to heading">â€‹</a></h2><p>Follow the below instructions to prepare your networks for asset exchange tests.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="initializing-the-fabric-networks-1">Initializing the Fabric Networks<a aria-hidden="true" class="hash-link" href="#initializing-the-fabric-networks-1" title="Direct link to heading">â€‹</a></h3><p>We use the Fabric CLI (<code>fabric-cli</code>) built earlier (in <code>samples/fabric/fabric-cli</code> and <code>samples/fabric/go-cli</code>) for this purpose.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="configuring-the-fabric-cli-1">Configuring the Fabric CLI<a aria-hidden="true" class="hash-link" href="#configuring-the-fabric-cli-1" title="Direct link to heading">â€‹</a></h4><p>The ledgers must be populated with sample key-value pairs for testing interoperation flows, scoped by the sample application chaincode.</p><p>Prepare <code>fabric-cli</code> for configuration suitably as follows.</p><ul><li>Navigate to the <code>samples/fabric/fabric-cli</code> (for the Node.js version) or the <code>samples/fabric/go-cli</code> (for the Golang version) folder.</li><li>Create a <code>config.json</code> file by copying the <code>config.template.json</code> and setting (or adding or removing) suitable values:<ul><li>For each network, the relay port and connection profile paths are specified using the keys <code>relayPort</code> and <code>connProfilePath</code> respectively.<ul><li>Replace <code>&lt;PATH-TO-WEAVER&gt;</code> with the absolute path location of the <code>weaver-dlt-interoperability</code> clone folder.</li><li>Set the <code>chaincode</code> attribute in each network to the deployed chaincode name (<code>simpleasset</code> or <code>simpleassetandinterop</code> or <code>simpleassettransfer</code>).</li><li>Otherwise, leave the default values unchanged.</li></ul></li></ul></li><li>Create a <code>.env</code> file by copying <code>.env.template</code> and setting following parameter values:<ul><li>If Relays and Drivers are deployed in the host machine:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MEMBER_CREDENTIAL_FOLDER=&lt;PATH-TO-WEAVER&gt;/samples/fabric/fabric-cli/src/data/credentials</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CONFIG_PATH=./config.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>If Relays and Drivers are deployed in the Docker containers:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MEMBER_CREDENTIAL_FOLDER=&lt;PATH-TO-WEAVER&gt;/samples/fabric/fabric-cli/src/data/credentials_docker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CONFIG_PATH=./config.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>In each case, replace <code>&lt;PATH-TO-WEAVER&gt;</code> with the location of your clone of Weaver.</li><li>Leave the default values unchanged for the other parameters.</li></ul></li><li>Run the following command:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/fabric-cli </span><span class="token function" style="color:rgb(130, 170, 255)">env</span><span class="token plain"> set-file ./.env</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><table><thead><tr><th align="left">Notes</th></tr></thead><tbody><tr><td align="left">If the <code>CONFIG_PATH</code> environment variable is omitted from <code>.env</code>, then you must also run:<br><code>./bin/fabric-cli config set-file ./config.json</code></td></tr></tbody></table></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="bootstrapping-network-and-application-state-1">Bootstrapping Network and Application State<a aria-hidden="true" class="hash-link" href="#bootstrapping-network-and-application-state-1" title="Direct link to heading">â€‹</a></h4><p>Finally, to prepare both <code>network1</code> and <code>network2</code> for interoperation, run:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./scripts/initAsset.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="initializing-the-corda-networks-1">Initializing the Corda Networks<a aria-hidden="true" class="hash-link" href="#initializing-the-corda-networks-1" title="Direct link to heading">â€‹</a></h3><p>Corda Network needs to be initialized with assets for asset-exchange to be performed:
Bootstrap the Corda network and application states as follows:</p><ul><li>Navigate to the <code>samples/corda/corda-simple-application</code> folder.</li><li>Run the following: <ul><li>For <code>cordaSimpleApplication</code> app, run:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./scripts/initAsset.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="next-steps-1">Next Steps<a aria-hidden="true" class="hash-link" href="#next-steps-1" title="Direct link to heading">â€‹</a></h3><p>The test networks are now configured and their ledgers are initialized. You can now run the <a href="/weaver-dlt-interoperability/docs/external/getting-started/interop/asset-exchange">asset exchange flows</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="preparation-for-asset-transfer">Preparation for Asset Transfer<a aria-hidden="true" class="hash-link" href="#preparation-for-asset-transfer" title="Direct link to heading">â€‹</a></h2><p>Follow the below instructions to prepare your networks for asset transfer tests.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="initializing-the-fabric-networks-2">Initializing the Fabric Networks<a aria-hidden="true" class="hash-link" href="#initializing-the-fabric-networks-2" title="Direct link to heading">â€‹</a></h3><p>We use the Fabric CLI (<code>fabric-cli</code>) built earlier (in <code>samples/fabric/fabric-cli</code> and <code>samples/fabric/go-cli</code>) for this purpose.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="configuring-the-fabric-cli-2">Configuring the Fabric CLI<a aria-hidden="true" class="hash-link" href="#configuring-the-fabric-cli-2" title="Direct link to heading">â€‹</a></h4><p>During bootstrap, the ledgers in both <code>network1</code> and <code>network2</code> must be populated with the following information scoped by the interoperation chaincode:</p><ul><li>Access control policies governing requests from foreign networks</li><li>Security group info for foreign networks (i.e., identities of network units and their membership providers&#x27; certificate chains)</li><li>Verification policies for proofs supplied by foreign networks
Knowledge of foreign networks that must be configured in this stage is as follows:</li><li><code>network1</code> has policies and security group info for <code>network2</code> and <code>Corda_Network</code></li><li><code>network2</code> has policies and security group info for <code>network1</code> and <code>Corda_Network</code>
(<em>The Corda sample application doesn&#x27;t support asset transfer yet, but there is no harm in including it above.</em>)
The ledgers must also be populated with sample key-value pairs for testing interoperation flows, scoped by the sample application chaincode.</li></ul><p>Prepare <code>fabric-cli</code> for configuration suitably as follows.</p><ul><li>Navigate to the <code>samples/fabric/fabric-cli</code> folder (<em>the Go CLI doesn&#x27;t support asset transfer yet</em>).</li><li>Create a <code>config.json</code> file by copying the <code>config.template.json</code> and setting (or adding or removing) suitable values:<ul><li>For each network, the relay port and connection profile paths are specified using the keys <code>relayPort</code> and <code>connProfilePath</code> respectively.<ul><li>Replace <code>&lt;PATH-TO-WEAVER&gt;</code> with the absolute path location of the <code>weaver-dlt-interoperability</code> clone folder.</li><li>Set the <code>chaincode</code> attribute in each network to <code>simpleassettransfer</code>.</li><li>Set the <code>aclPolicyPrincipalType</code> attribute in <code>network2</code> to <code>ca</code>.</li><li>Otherwise, leave the default values unchanged.</li></ul></li></ul></li><li>Create <code>remote-network-config.json</code> file by copying <code>remote-network-config.json.template</code>. Use default values if relays and drivers are deployed in the host machine; else if they are deployed in Docker, update as follows:<ul><li>Update value for <code>relayEndpoint</code> for <code>network1</code> as <code>relay-network1:9080</code>.</li><li>Update value for <code>relayEndpoint</code> for <code>network2</code> as <code>relay-network2:9083</code>.</li><li>Update value for <code>relayEndpoint</code> for <code>Corda_Network</code> as <code>relay-corda:9081</code>.</li><li>Update value for <code>relayEndpoint</code> for <code>Corda_Network2</code> as <code>relay-corda2:9082</code>.</li><li>Update value for <code>partyEndPoint</code> for <code>Corda_Network</code> as <code>corda_partya_1:10003</code>.</li><li>Update value for <code>partyEndPoint</code> for <code>Corda_Network2</code> as <code>corda_network2_partya_1:10003</code>.</li></ul></li><li>Create <code>chaincode.json</code> file by copying <code>chaincode.json.template</code>. Keep the default values unchanged.</li><li>Create a <code>.env</code> file by copying <code>.env.template</code> and setting the following parameter values:<ul><li>If Relays and Drivers are deployed in the host machine:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MEMBER_CREDENTIAL_FOLDER=&lt;PATH-TO-WEAVER&gt;/samples/fabric/fabric-cli/src/data/credentials</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFAULT_APPLICATION_CHAINCODE=simpleassettransfer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CONFIG_PATH=./config.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">REMOTE_CONFIG_PATH=./remote-network-config.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CHAINCODE_PATH=./chaincode.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>If Relays and Drivers are deployed in the Docker containers:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MEMBER_CREDENTIAL_FOLDER=&lt;PATH-TO-WEAVER&gt;/samples/fabric/fabric-cli/src/data/credentials_docker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">DEFAULT_APPLICATION_CHAINCODE=simpleassettransfer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CONFIG_PATH=./config.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">REMOTE_CONFIG_PATH=./remote-network-config.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CHAINCODE_PATH=./chaincode.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>In each case, replace <code>&lt;PATH-TO-WEAVER&gt;</code> with the location of your clone of Weaver.</li><li>Leave the default values unchanged for the other parameters.</li></ul></li><li>Run the following command:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/fabric-cli env set-file ./.env</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><table><thead><tr><th align="left">Notes</th></tr></thead><tbody><tr><td align="left">If the <code>CONFIG_PATH</code> environment variable is omitted from <code>.env</code>, then you must also run:<br><code>./bin/fabric-cli config set-file ./config.json</code></td></tr></tbody></table></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="bootstrapping-network-and-application-state-2">Bootstrapping Network and Application State<a aria-hidden="true" class="hash-link" href="#bootstrapping-network-and-application-state-2" title="Direct link to heading">â€‹</a></h4><p>Create appropriate access control and verification policies for <code>network1</code> and <code>network2</code> by running:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/fabric-cli configure create all --local-network</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">network1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/fabric-cli configure create all --local-network</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">network2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Load access control and verification policies onto the ledgers of <code>network1</code> and <code>network2</code> by running:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/fabric-cli configure network --local-network</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">network1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/fabric-cli configure network --local-network</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">network2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Initialize bond and token asset states and ownerships on the <code>network1</code> ledger by running the following (this step will also create a user <code>alice</code> in <code>network1</code> and a user <code>bob</code> in <code>network2</code>):</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./scripts/initAssetsForTransfer.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="initializing-the-corda-networks-2">Initializing the Corda Networks<a aria-hidden="true" class="hash-link" href="#initializing-the-corda-networks-2" title="Direct link to heading">â€‹</a></h3><p>Once the Corda networks (<code>Corda_Network</code> and <code>Corda_Network2</code>) are launched, the client applications (built earlier) needs to be exercised to generate ledger state in both exporting/source and importing/destination networks in preparation to test asset transfer interoperation flows.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="bootstrapping-networks-and-application-states-1">Bootstrapping Networks and Application States<a aria-hidden="true" class="hash-link" href="#bootstrapping-networks-and-application-states-1" title="Direct link to heading">â€‹</a></h4><p>The Corda network ledger (or <em>vault</em> on each node) must be initialized with access control policies, verification policies, and security group information for the other networks (two Fabric networks and other Corda network).</p><p>Bootstrap the Corda networks and application states as follows (<em>the following instructions will initialize either or both Corda networks, depending on which of those are up and running</em>):</p><ul><li>Navigate to the <code>samples/corda/corda-simple-application</code> folder.</li><li>Run the following:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> clients/src/main/resources/config/remote-network-config.json.template clients/src/main/resources/config/remote-network-config.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div>Use default values in <code>remote-network-config.json</code> if relays and drivers are deployed in the host machine; else if they are deployed in Docker, update as follows:<ul><li>Update value for <code>relayEndpoint</code> for <code>network1</code> as <code>relay-network1:9080</code>.</li><li>Update value for <code>relayEndpoint</code> for <code>network2</code> as <code>relay-network2:9083</code>.</li><li>Update value for <code>relayEndpoint</code> for <code>Corda_Network</code> as <code>relay-corda:9081</code>.</li><li>Update value for <code>relayEndpoint</code> for <code>Corda_Network2</code> as <code>relay-corda2:9082</code>.</li><li>Update value for <code>partyEndPoint</code> for <code>Corda_Network</code> as <code>corda_partya_1:10003</code>.</li><li>Update value for <code>partyEndPoint</code> for <code>Corda_Network2</code> as <code>corda_network2_partya_1:10003</code>.</li></ul></li><li>Run the following: <ul><li>If Relays and Drivers are deployed in the host machine:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">make</span><span class="token plain"> initialise-vault-asset-transfer</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>If Relays and Drivers are deployed in the Docker containers:<div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">make</span><span class="token plain"> initialise-vault-asset-transfer-docker</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="next-steps-2">Next Steps<a aria-hidden="true" class="hash-link" href="#next-steps-2" title="Direct link to heading">â€‹</a></h3><p>The test networks are now configured and their ledgers are initialized. You can now run the <a href="/weaver-dlt-interoperability/docs/external/getting-started/interop/asset-transfer">asset transfer flows</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/hyperledger-labs/weaver-dlt-interoperability/edit/master/docs/external/getting-started/test-network/ledger-initialization.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/weaver-dlt-interoperability/docs/external/getting-started/test-network/overview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Component Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/weaver-dlt-interoperability/docs/external/getting-started/interop/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testing Interoperation Modes<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#preparation-for-data-sharing" class="table-of-contents__link toc-highlight">Preparation for Data Sharing</a><ul><li><a href="#initializing-the-fabric-networks" class="table-of-contents__link toc-highlight">Initializing the Fabric Networks</a></li><li><a href="#initializing-the-corda-networks" class="table-of-contents__link toc-highlight">Initializing the Corda Networks</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></li><li><a href="#preparation-for-asset-exchange" class="table-of-contents__link toc-highlight">Preparation for Asset Exchange</a><ul><li><a href="#initializing-the-fabric-networks-1" class="table-of-contents__link toc-highlight">Initializing the Fabric Networks</a></li><li><a href="#initializing-the-corda-networks-1" class="table-of-contents__link toc-highlight">Initializing the Corda Networks</a></li><li><a href="#next-steps-1" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></li><li><a href="#preparation-for-asset-transfer" class="table-of-contents__link toc-highlight">Preparation for Asset Transfer</a><ul><li><a href="#initializing-the-fabric-networks-2" class="table-of-contents__link toc-highlight">Initializing the Fabric Networks</a></li><li><a href="#initializing-the-corda-networks-2" class="table-of-contents__link toc-highlight">Initializing the Corda Networks</a></li><li><a href="#next-steps-2" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Weaver Framework.</div></div></div></footer></div>
<script src="/weaver-dlt-interoperability/assets/js/runtime~main.862315ac.js"></script>
<script src="/weaver-dlt-interoperability/assets/js/main.5ca17011.js"></script>
</body>
</html>